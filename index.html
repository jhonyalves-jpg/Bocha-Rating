<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Ratings da Bocha</title>

<style>
body { font-family: Arial, Helvetica, sans-serif; background:#f4f6f8; margin:0; padding:20px; }
h1,h2 { text-align:center; }
table { width:100%; max-width:900px; margin:20px auto; border-collapse:collapse; background:#fff; box-shadow:0 2px 6px rgba(0,0,0,.1);}    
th,td { padding:8px; text-align:center; border-bottom:1px solid #ddd; }
th { background:#222; color:#fff; }
tr:nth-child(even){ background:#f2f2f2; }
.box { max-width:900px; margin:20px auto; background:#fff; padding:15px; box-shadow:0 2px 6px rgba(0,0,0,.1); }
input, select, button { padding:6px; margin:3px; }
button { cursor:pointer; }
.btn-del { background:#c0392b; color:#fff; border:none; padding:5px 8px; }

.admin-toggle {
  position:fixed;
  bottom:20px;
  right:20px;
  background:#222;
  color:#fff;
  border:none;
  padding:10px 14px;
  border-radius:50px;
}
.admin-panel {
  display:none;
  max-width:900px;
  margin:30px auto;
  background:#fff;
  padding:15px;
  box-shadow:0 2px 6px rgba(0,0,0,.2);
  border:2px dashed #444;
}
.footer { text-align:center; font-size:14px; color:#666; margin-top:30px; }
</style>
</head>

<body>

<h1>üèÜ Ranking de Ratings</h1>

<!-- =================== TABELA P√öBLICA =================== -->
<table>
<thead>
<tr>
  <th>#</th>
  <th>Jogador</th>
  <th>Rating</th>
  <th>V</th>
  <th>D</th>
</tr>
</thead>
<tbody id="ranking"></tbody>
</table>

<!-- =================== HIST√ìRICO P√öBLICO =================== -->
<div class="box">
<h2>üìú Hist√≥rico de Partidas</h2>
<table>
<thead>
<tr><th>Jogador A</th><th>Resultado</th><th>Jogador B</th></tr>
</thead>
<tbody id="historico"></tbody>
</table>
</div>

<!-- =================== PAINEL ADMIN =================== -->
<div class="admin-panel" id="adminPanel">
<h2>‚öôÔ∏è Painel Administrativo</h2>

<!-- ‚ûï ADICIONAR JOGADOR (MOVIDO) -->
<div class="box">
<h2>‚ûï Adicionar Jogador</h2>
<input id="novoNome" placeholder="Nome" />
<input id="novoRating" type="number" value="1500" />
<input id="novoV" type="number" value="0" />
<input id="novoD" type="number" value="0" />
<button onclick="adicionarJogador()">Adicionar</button>
</div>

<!-- ‚ôüÔ∏è REGISTRAR PARTIDA (MOVIDO) -->
<div class="box">
<h2>‚ôüÔ∏è Registrar Partida</h2>
<select id="jogadorA"></select>
<select id="resultado">
  <option value="1">Vit√≥ria A</option>
  <option value="0.5">Empate</option>
  <option value="0">Derrota A</option>
</select>
<select id="jogadorB"></select>
<button onclick="registrarPartida()">Salvar Partida</button>
</div>

<!-- TABELA ADMIN -->
<table>
<thead>
<tr>
  <th>Jogador</th>
  <th>Rating</th>
  <th>V</th>
  <th>D</th>
  <th>A√ß√µes</th>
</tr>
</thead>
<tbody id="adminTabela"></tbody>
</table>

</div>

<button class="admin-toggle" onclick="toggleAdmin()">‚öôÔ∏è Admin</button>

<div class="footer">Sistema Elo ‚Ä¢ K=20 ‚Ä¢ Dados salvos no navegador</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCbiajdXpoQH72dLWv-qHmqx2-yYFggH4g",
  authDomain: "bocha-rating.firebaseapp.com",
  projectId: "bocha-rating",
  storageBucket: "bocha-rating.firebasestorage.app",
  messagingSenderId: "912115850854",
  appId: "1:912115850854:web:451f23ec2b47474a16d7a7"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* ==== DADOS ==== */
const K = 20;
let jogadores = [];
let historico = [];

/* ==== FIREBASE ==== */
async function carregar(){
  const ref = doc(db, "bocha", "dados");
  const snap = await getDoc(ref);

  if(snap.exists()){
    jogadores = snap.data().jogadores || [];
    historico = snap.data().historico || [];
  } else {
    await salvar();
  }

  atualizarRanking();
  atualizarHistorico();
}

async function salvar(){
  await setDoc(doc(db, "bocha", "dados"), { jogadores, historico });
}

/* ==== RESTO DO TEU C√ìDIGO ==== */
function esperado(ra, rb){
  return 1 / (1 + Math.pow(10,(rb-ra)/400));
}

/* (o resto das fun√ß√µes continuam iguais) */

const historicoElem = document.getElementById('historico');
carregar();
</script>


</body>
</html>
